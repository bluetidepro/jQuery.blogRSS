/* ===========================================================
 * jQuery.blogRSS v1.0
 * ===========================================================
 * Copyright 2013 Zach Reed.
 * http://www.iamzachreed.com
 * Pull your RSS blog into website
 * License: GPL v3
 *
 * -----------------
 *
 * Timeago
 * @version 1.3.0
 * @requires jQuery v1.2.3+
 * @author Ryan McGeary
 * @license MIT License - http://www.opensource.org/licenses/mit-license.php
 * Copyright (c) 2008-2013, Ryan McGeary (ryan -[at]- mcgeary [*dot*] org)
 * ========================================================== */
!function(e){function t(e){if(typeof console=="object")console.log(e);else if(typeof opera=="object")opera.postError(e)}function n(e){alert("blogRSS ERROR: "+e)}function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}(function(e){if(typeof define==="function"&&define.amd){define(["jquery"],e)}else{e(jQuery)}})(function(e){function t(){var t=n(this);var o=s.settings;if(!isNaN(t.datetime)){if(o.cutoff==0||i(t.datetime)<o.cutoff){e(this).text(r(t.datetime))}}return this}function n(t){t=e(t);if(!t.data("timeago")){t.data("timeago",{datetime:s.datetime(t)});var n=e.trim(t.text());if(s.settings.localeTitle){t.attr("title",t.data("timeago").datetime.toLocaleString())}else if(n.length>0&&!(s.isTime(t)&&t.attr("title"))){t.attr("title",n)}}return t.data("timeago")}function r(e){return s.inWords(i(e))}function i(e){return(new Date).getTime()-e.getTime()}e.timeago=function(t){if(t instanceof Date){return r(t)}else if(typeof t==="string"){return r(e.timeago.parse(t))}else if(typeof t==="number"){return r(new Date(t))}else{return r(e.timeago.datetime(t))}};var s=e.timeago;e.extend(e.timeago,{settings:{refreshMillis:6e4,allowFuture:false,localeTitle:false,cutoff:0,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"about %d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years",wordSeparator:" ",numbers:[]}},inWords:function(t){function n(n,i){var s=e.isFunction(n)?n(i,t):n;var o=r.numbers&&r.numbers[i]||i;return s.replace(/%d/i,o)}var r=this.settings.strings;var i=r.prefixAgo;var s=r.suffixAgo;if(this.settings.allowFuture){if(t<0){i=r.prefixFromNow;s=r.suffixFromNow}}var o=Math.abs(t)/1e3;var u=o/60;var a=u/60;var f=a/24;var l=f/365;var c=o<45&&n(r.seconds,Math.round(o))||o<90&&n(r.minute,1)||u<45&&n(r.minutes,Math.round(u))||u<90&&n(r.hour,1)||a<24&&n(r.hours,Math.round(a))||a<42&&n(r.day,1)||f<30&&n(r.days,Math.round(f))||f<45&&n(r.month,1)||f<365&&n(r.months,Math.round(f/30))||l<1.5&&n(r.year,1)||n(r.years,Math.round(l));var h=r.wordSeparator||"";if(r.wordSeparator===undefined){h=" "}return e.trim([i,c,s].join(h))},parse:function(t){var n=e.trim(t);n=n.replace(/\.\d+/,"");n=n.replace(/-/,"/").replace(/-/,"/");n=n.replace(/T/," ").replace(/Z/," UTC");n=n.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2");return new Date(n)},datetime:function(t){var n=s.isTime(t)?e(t).attr("datetime"):e(t).attr("title");return s.parse(n)},isTime:function(t){return e(t).get(0).tagName.toLowerCase()==="time"}});var o={init:function(){var n=e.proxy(t,this);n();var r=s.settings;if(r.refreshMillis>0){this._timeagoInterval=setInterval(n,r.refreshMillis)}},update:function(n){var r=s.parse(n);e(this).data("timeago",{datetime:r});if(s.settings.localeTitle)e(this).attr("title",r.toLocaleString());t.apply(this)},updateFromDOM:function(){e(this).data("timeago",{datetime:s.parse(s.isTime(this)?e(this).attr("datetime"):e(this).attr("title"))});t.apply(this)},dispose:function(){if(this._timeagoInterval){window.clearInterval(this._timeagoInterval);this._timeagoInterval=null}}};e.fn.timeago=function(e,t){var n=e?o[e]:o.init;if(!n){throw new Error("Unknown function name '"+e+"' for timeago")}this.each(function(){n.call(this,t)});return this};document.createElement("abbr");document.createElement("time")});var i={feedURL:"",blogURL:"",ulContainerID:"",blogName:"",blogDescription:""};e.fn.blogRSS=function(t){var s=e.extend({},i,t),o=e(this);if(s.feedURL==""){n("Please enter your RSS feed URL.")}else if(s.blogURL==""){n("Please enter your blog URL.")}else if(s.ulContainerID==""){n("Please enter your ul container ID.")}else{e(s.ulContainerID).addClass("blog-entries");e.ajax({url:document.location.protocol+"//ajax.googleapis.com/ajax/services/feed/load?v=1.0&num=10&callback=?&q="+encodeURIComponent(s.feedURL),dataType:"json",success:function(t){s.blogName?s.blogName:s.blogName=r(t.responseData.feed.title);e(s.ulContainerID).wrap('<div class="blog-entries-container"></div>').before("<h1>"+s.blogName+"</h1><h2>"+(s.blogDescription?s.blogDescription:t.responseData.feed.description)+"</h2>");e.each(t.responseData.feed.entries,function(t,n){categories="";if(n.categories){var r=e(n.categories).length;e.each(n.categories,function(e,t){categories+=t+", ";if(e===r-1){categories+=t}})}entryHTML='<header><h3><a href="'+n.link+'" target="_blank">'+n.title+"</a></h3></header>";entryHTML+='<footer>Posted <time title="'+n.publishedDate+'" datetime="'+n.publishedDate+'">'+jQuery.timeago(n.publishedDate)+"</time>"+(categories?' in <span class="entry-categories">'+categories+"</span>":"")+"</footer>";entryHTML+="<p>"+n.content+"</p>";e('<li class="blog-entry"><article>'+entryHTML+"</article></li>").appendTo(s.ulContainerID)});e('<li class="view-all-entries"><a href="'+s.blogURL+'" title="'+s.blogName+'">View full blog Â»</a></li>').appendTo(s.ulContainerID)}})}}}(window.jQuery)
