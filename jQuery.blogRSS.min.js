/* ===========================================================
 * jQuery.blogRSS v1.1.0
 * ===========================================================
 * Copyright 2013 Zach Reed.
 * http://www.iamzachreed.com
 * Pull your RSS blog into website
 * License: GPL v3
 *
 * -----------------
 *
 * Timeago
 * @version 1.3.0
 * @requires jQuery v1.2.3+
 * @author Ryan McGeary
 * @license MIT License - http://www.opensource.org/licenses/mit-license.php
 * Copyright (c) 2008-2013, Ryan McGeary (ryan -[at]- mcgeary [*dot*] org)
 * ========================================================== */
!function(a){function c(a){alert("blogRSS ERROR: "+a)}function d(a){return a.charAt(0).toUpperCase()+a.slice(1)}!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){function b(){var b=c(this),g=f.settings;return isNaN(b.datetime)||(0==g.cutoff||e(b.datetime)<g.cutoff)&&a(this).text(d(b.datetime)),this}function c(b){if(b=a(b),!b.data("timeago")){b.data("timeago",{datetime:f.datetime(b)});var c=a.trim(b.text());f.settings.localeTitle?b.attr("title",b.data("timeago").datetime.toLocaleString()):!(c.length>0)||f.isTime(b)&&b.attr("title")||b.attr("title",c)}return b.data("timeago")}function d(a){return f.inWords(e(a))}function e(a){return(new Date).getTime()-a.getTime()}a.timeago=function(b){return d(b instanceof Date?b:"string"==typeof b?a.timeago.parse(b):"number"==typeof b?new Date(b):a.timeago.datetime(b))};var f=a.timeago;a.extend(a.timeago,{settings:{refreshMillis:6e4,allowFuture:!1,localeTitle:!1,cutoff:0,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"about %d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years",wordSeparator:" ",numbers:[]}},inWords:function(b){function c(c,e){var f=a.isFunction(c)?c(e,b):c,g=d.numbers&&d.numbers[e]||e;return f.replace(/%d/i,g)}var d=this.settings.strings,e=d.prefixAgo,f=d.suffixAgo;this.settings.allowFuture&&b<0&&(e=d.prefixFromNow,f=d.suffixFromNow);var g=Math.abs(b)/1e3,h=g/60,i=h/60,j=i/24,k=j/365,l=g<45&&c(d.seconds,Math.round(g))||g<90&&c(d.minute,1)||h<45&&c(d.minutes,Math.round(h))||h<90&&c(d.hour,1)||i<24&&c(d.hours,Math.round(i))||i<42&&c(d.day,1)||j<30&&c(d.days,Math.round(j))||j<45&&c(d.month,1)||j<365&&c(d.months,Math.round(j/30))||k<1.5&&c(d.year,1)||c(d.years,Math.round(k)),m=d.wordSeparator||"";return void 0===d.wordSeparator&&(m=" "),a.trim([e,l,f].join(m))},parse:function(b){var c=a.trim(b);return c=c.replace(/\.\d+/,""),c=c.replace(/-/,"/").replace(/-/,"/"),c=c.replace(/T/," ").replace(/Z/," UTC"),c=c.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2"),new Date(c)},datetime:function(b){var c=f.isTime(b)?a(b).attr("datetime"):a(b).attr("title");return f.parse(c)},isTime:function(b){return"time"===a(b).get(0).tagName.toLowerCase()}});var g={init:function(){var c=a.proxy(b,this);c();var d=f.settings;d.refreshMillis>0&&(this._timeagoInterval=setInterval(c,d.refreshMillis))},update:function(c){var d=f.parse(c);a(this).data("timeago",{datetime:d}),f.settings.localeTitle&&a(this).attr("title",d.toLocaleString()),b.apply(this)},updateFromDOM:function(){a(this).data("timeago",{datetime:f.parse(f.isTime(this)?a(this).attr("datetime"):a(this).attr("title"))}),b.apply(this)},dispose:function(){this._timeagoInterval&&(window.clearInterval(this._timeagoInterval),this._timeagoInterval=null)}};a.fn.timeago=function(a,b){var c=a?g[a]:g.init;if(!c)throw new Error("Unknown function name '"+a+"' for timeago");return this.each(function(){c.call(this,b)}),this},document.createElement("abbr"),document.createElement("time")});var e={feedURL:"",blogURL:"",ulContainerID:"",blogName:"",blogDescription:""};a.fn.blogRSS=function(b){var f=a.extend({},e,b);a(this);""==f.feedURL?c("Please enter your RSS feed URL."):""==f.blogURL?c("Please enter your blog URL."):""==f.ulContainerID?c("Please enter your ul container ID."):(a(f.ulContainerID).addClass("blog-entries"),a.ajax({url:document.location.protocol+"//query.yahooapis.com/v1/public/yql?q=select%20*%20from%20xml%20where%20url%3D'"+encodeURIComponent(f.feedURL)+"'&format=json&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys",dataType:"json",success:function(b){var b=b.query.results.rss.channel;f.blogName?f.blogName:f.blogName=d(b.title),a(f.ulContainerID).wrap('<div class="blog-entries-container"></div>').before("<h1>"+f.blogName+"</h1><h2>"+(f.blogDescription?f.blogDescription:b.description)+"</h2>"),a.each(b.item,function(b,c){if(categories="",c.category){var d=a(c.category).length;a.each(c.category,function(a,b){categories+=b+", ",a===d-1&&(categories+=b)})}entryHTML='<header><h3><a href="'+c.link+'" target="_blank">'+c.title+"</a></h3></header>",entryHTML+='<footer>Posted <time title="'+c.pubDate+'" datetime="'+c.pubDate+'">'+jQuery.timeago(c.pubDate)+"</time>"+(categories?' in <span class="entry-categories">'+categories+"</span>":"")+"</footer>",entryHTML+="<p>"+c.description+"</p>",a('<li class="blog-entry"><article>'+entryHTML+"</article></li>").appendTo(f.ulContainerID)}),a('<li class="view-all-entries"><a href="'+f.blogURL+'" title="'+f.blogName+'">View full blog &raquo;</a></li>').appendTo(f.ulContainerID)}}))}}(window.jQuery);
